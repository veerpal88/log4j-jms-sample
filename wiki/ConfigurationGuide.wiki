#A simple configuration guide of how you use [http://logging.apache.org/log4j/1.2/ Log4j] JMSAppender with [http://activemq.apache.org/ Apache ActiveMQ]

= Steps =

== Step1 ==

Add the following dependencies to your pom.xml

{{{
		<dependency>
			<groupId>org.slf4j</groupId>
			<artifactId>slf4j-api</artifactId>
			<version>1.6.1</version>
			<scope>compile</scope>
		</dependency>
		<dependency>
			<groupId>org.slf4j</groupId>
			<artifactId>slf4j-log4j12</artifactId>
			<version>1.6.1</version>
			<scope>compile</scope>
			<exclusions>
				<exclusion>
					<groupId>javax.mail</groupId>
					<artifactId>mail</artifactId>
				</exclusion>
				<exclusion>
					<groupId>javax.mail</groupId>
					<artifactId>mail</artifactId>
				</exclusion>
				<exclusion>
					<groupId>javax.jms</groupId>
					<artifactId>jms</artifactId>
				</exclusion>
				<exclusion>
					<groupId>com.sun.jdmk</groupId>
					<artifactId>jmxtools</artifactId>
				</exclusion>
				<exclusion>
					<groupId>com.sun.jmx</groupId>
					<artifactId>jmxri</artifactId>
				</exclusion>
			</exclusions>
		</dependency>
		<dependency>
			<groupId>org.apache.activemq</groupId>
			<artifactId>activemq-all</artifactId>
			<version>5.4.1</version>
			<scope>compile</scope>
		</dependency>

}}} 

Please note we are using slf4j, you can also use commons-logging, but the former one is recommended. <font color=red> Another thing to notice is the dependency of activemq-all, don't change it to activemq-core, I've tested many times only the former one will work well.</font>

== Step2 ==

Put this [http://code.google.com/p/log4j-jms-sample/source/browse/trunk/src/main/resources/jndi.properties jndi.properties] to your classpath.

== Step3 ==

Put this [http://code.google.com/p/log4j-jms-sample/source/browse/trunk/src/main/resources/log4j.xml log4j.xml] in your classpath, change the configuration values according to your environment.

Please not we are not using log4j.properties because log4j.xml has a higher priority.

== Step4 ==

Run a broker at tcp://localhost:61616, for convenience we have provided an [http://code.google.com/p/log4j-jms-sample/source/browse/trunk/src/main/java/com/snda/infrastructure/log4j/jms/sample/EmbeddedBroker.java EmbeddedBroker], please feel free to use it,  alternatively you can run a standalone broker according to the [http://activemq.apache.org/getting-started.html#GettingStarted-StartingActiveMQ official reference].

== Step5 ==

Simply send a log and it's will 